# Spam Email Analysis & Reply Generation Project

## Project Overview
This project analyzes emails for spam detection and generates intelligent replies using fine-tuned LLMs. It includes both backend AI models and a user-friendly Streamlit WebUI.

## Project Structure

### Backend Components
- **preprocessing.py**: Preprocesses the DailyDialog dataset into email-style prompt-response pairs
- **train.py**: Fine-tunes GPT-2/DistilGPT-2 with LoRA for email reply generation
- **train_0.py**: Alternative training script

### Frontend
- **app.py**: Streamlit WebUI for email analysis and reply generation (NEW)

### Data
- **data/email_reply_dataset/**: Preprocessed training data for LLM

## Setup & Usage

### 1. Data Preprocessing
```bash
python preprocessing.py \
  --dataset_name kmyoo/dailydialog-tiny \
  --output_dir ./data/email_reply_dataset \
  --style support
```
This saves the processed dataset to `data/email_reply_dataset`.

### 2. Model Training
```bash
# Full parameter fine-tuning
python train.py --model_name gpt2

# With LoRA (recommended)
python train.py --model_name gpt2 --use_lora
```

The current code ignores evaluation to ensure it runs locally. Results are saved to `./results/`.

### 3. Running the WebUI (NEW - v0.1)
```bash
pip install -r requirements.txt
streamlit run app.py
```

## Recent Updates (v0.1)

### New: Streamlit WebUI (`app.py`)
A fully functional web interface with:

#### Features:
- **ðŸ” Email Analysis Tab**: Analyze emails for spam detection and reply generation
- **ðŸ“‹ History Tab**: View past analyses with timestamps and generated replies
- **âš™ï¸ Settings Tab**: Configure models, thresholds, and advanced options

#### Current Implementation:
- **Mock Spam Classifier**: Random classification (70-99% confidence) - ready for model integration
- **Mock LLM Generator**: Generic predetermined responses - ready for actual model integration
- Session state management for analysis history
- Professional UI with color-coded badges and styling
- Copy/download functionality for generated replies

#### Integration Points:
To integrate your actual models:
1. Replace `MockSpamClassifier.predict()` in `app.py` with your trained spam detection model
2. Replace `MockLLMReplyGenerator.generate_reply()` with your fine-tuned GPT-2/DistilGPT-2
3. Update model loading logic in the Settings tab

### New: Requirements File (`requirements.txt`)
Added comprehensive dependencies list for easy setup.

## Dependencies
- streamlit >= 1.28.0
- torch >= 2.0.0
- transformers >= 4.30.0
- datasets >= 2.13.0
- peft >= 0.4.0
- evaluate >= 0.4.0
- numpy >= 1.24.0

## Notes
- Result folders generated by `train.py` have been manually deleted to keep the repository clean
- The preprocessing and training code ignores evaluation metrics to ensure local execution
- The WebUI skeleton is ready for production-ready model integration
